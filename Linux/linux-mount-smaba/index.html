<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Linux挂载smaba目录 · maohhgg</title><meta name="description" content="Linux挂载smaba目录 - maohhgg"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://maohhgg.github.io/atom.xml" title="maohhgg"><meta name="generator" content="Hexo 4.0.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAG</a></li><li class="nav-list-item"><a href="https://github.com/maohhgg" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Linux挂载smaba目录</h1><div class="post-tags"><a href="/tags/Android/">#Android</a></div><div class="post-info">2017年5月30日</div><div class="post-content"><p>本地Linux版本是elementary OS 0.4.1 Loki，是基于 “Ubuntu 16.04.2 LTS” 构建的Linux发行版，相当于Ubuntu 16.04。</p>
<a id="more"></a>
<h3 id="使用mount挂载"><a href="#使用mount挂载" class="headerlink" title="使用mount挂载"></a>使用mount挂载</h3><p>先要安装cifs-utils</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt install cifs-utils</span></span></pre></td></tr></table></figure>

<h4 id="mount命令"><a href="#mount命令" class="headerlink" title="mount命令"></a>mount命令</h4><p>查看 mount 命令了解如何使用，具体属性：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> man mount</span></span></pre></td></tr></table></figure>

<p>我们需要使用-t -o 两个参数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"> -o, --options opts</span></pre></td></tr><tr><td class="code"><pre><span class="line">              Use the specified mount options.  The opts argument is a comma-separated list.  For example:</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">                     mount LABEL&#x3D;mydisk -o noatime,nodev,nosuid</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              For more details, see the FILESYSTEM-INDEPENDENT MOUNT OPTIONS and FILESYSTEM-SPECIFIC MOUNT OPTIONS sections.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">-t, --types fstype</span></pre></td></tr><tr><td class="code"><pre><span class="line">              The argument following the -t is used to indicate the filesystem type.  The filesystem types which are currently supported  depend  on  the  running  kernel.   See</span></pre></td></tr><tr><td class="code"><pre><span class="line">              &#x2F;proc&#x2F;filesystems  and  &#x2F;lib&#x2F;modules&#x2F;$(uname  -r)&#x2F;kernel&#x2F;fs for a complete list of the filesystems.  The most common are ext2, ext3, ext4, xfs, btrfs, vfat, sysfs,</span></pre></td></tr><tr><td class="code"><pre><span class="line">              proc, nfs and cifs.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              The programs mount and umount support filesystem subtypes.  The subtype is defined by a &#39;.subtype&#39; suffix.  For example  &#39;fuse.sshfs&#39;.   It&#39;s  recommended  to  use</span></pre></td></tr><tr><td class="code"><pre><span class="line">              subtype notation rather than add any prefix to the mount source (for example &#39;sshfs#example.com&#39; is deprecated).</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              If  no  -t  option  is given, or if the auto type is specified, mount will try to guess the desired type.  Mount uses the blkid library for guessing the filesystem</span></pre></td></tr><tr><td class="code"><pre><span class="line">              type; if that does not turn up anything that looks familiar, mount will try to read the file &#x2F;etc&#x2F;filesystems, or, if that does not exist, &#x2F;proc&#x2F;filesystems.   All</span></pre></td></tr><tr><td class="code"><pre><span class="line">              of  the  filesystem  types  listed there will be tried, except for those that are labeled &quot;nodev&quot; (e.g., devpts, proc and nfs).  If &#x2F;etc&#x2F;filesystems ends in a line</span></pre></td></tr><tr><td class="code"><pre><span class="line">              with a single *, mount will read &#x2F;proc&#x2F;filesystems afterwards.  While trying, all filesystem types will be mounted with the mount option silent.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              The auto type may be useful for user-mounted floppies.  Creating a file &#x2F;etc&#x2F;filesystems can be useful to change the probe order (e.g., to try vfat before msdos or</span></pre></td></tr><tr><td class="code"><pre><span class="line">              ext3 before ext2) or if you use a kernel module autoloader.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              More  than one type may be specified in a comma-separated list, for option -t as well as in an &#x2F;etc&#x2F;fstab entry.  The list of filesystem types for option -t can be</span></pre></td></tr><tr><td class="code"><pre><span class="line">              prefixed with no to specify the filesystem types on which no action should be taken.  The prefix no has no effect when specified in an &#x2F;etc&#x2F;fstab entry.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              The prefix no can be meaningful with the -a option.  For example, the command</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">                     mount -a -t nomsdos,smbfs</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              mounts all filesystems except those of type msdos and smbfs.</span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line">              For most types all the mount program has to do is issue a simple mount(2) system call, and no detailed knowledge of the filesystem type is  required.   For  a  few</span></pre></td></tr><tr><td class="code"><pre><span class="line">              types  however  (like nfs, nfs4, cifs, smbfs, ncpfs) an ad hoc code is necessary.  The nfs, nfs4, cifs, smbfs, and ncpfs filesystems have a separate mount program.</span></pre></td></tr><tr><td class="code"><pre><span class="line">              In order to make it possible to treat all types in a uniform way, mount will execute the program &#x2F;sbin&#x2F;mount.type (if that exists)  when  called  with  type  type.</span></pre></td></tr><tr><td class="code"><pre><span class="line">              Since different versions of the smbmount program have different calling conventions, &#x2F;sbin&#x2F;mount.smbfs may have to be a shell script that sets up the desired call.</span></pre></td></tr></table></figure>

<h4 id="附加的参数（-o-–options）"><a href="#附加的参数（-o-–options）" class="headerlink" title="附加的参数（-o –options）"></a>附加的参数（-o –options）</h4><p>在连接smaba服务时，需要使用用户名和密码，所以参数加上用户名和密码，也可以加上所在域</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-o username&#x3D;name,password&#x3D;passwd,domain&#x3D;WORKGROUP</span></pre></td></tr></table></figure>
<p>也可以写作</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-o username&#x3D;name@WORKGROUP,password&#x3D;passwd</span></pre></td></tr></table></figure>
<p>如果smaba允许匿名访问，参数也可以使用匿名。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-o guest</span></pre></td></tr></table></figure>
<p>我们还可以指定访问的权限，例如获取读写的全部权限，这需要被smaba共享目录的权限大于等于访问权限。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-o rw,file_mode&#x3D;0777,dir_mode&#x3D;0777</span></pre></td></tr></table></figure>
<p>有时需要在Terminal操作，为了方便，不用每次都使用<code>sudo</code>,我们也可以指定访问的用户。比如共享目录的所有者为<code>pi</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-o uid&#x3D;pi</span></pre></td></tr></table></figure>
<p>我这里本地机的普通用户是<code>pi</code>，samba服务器的用户也为<code>pi</code>，共享目录文件的所有者也为<code>pi</code>。也可以实现上面的作用。<br>也可以将贡献目录的所有者和所在组改为本地机相同就可以了，比如本地机组和用户为<code>pi:pi</code>。在samba服务器上对目标文件执行。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo chown pi:pi -R dir/</span></span></pre></td></tr></table></figure>
<p>当服务器和客户端为不同的操作系统，Windows和Linux，需要指定访问的编码。服务器为Linux设定为utf8，Windows设定为cp936。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-t iocharset&#x3D;utf8</span></pre></td></tr></table></figure>

<h4 id="挂载的类型（-t-–types）"><a href="#挂载的类型（-t-–types）" class="headerlink" title="挂载的类型（-t –types）"></a>挂载的类型（-t –types）</h4><p>在Ubuntu 12.10以后使用cifs-utils，所以挂载类型为</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-t cifs</span></pre></td></tr></table></figure>

<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>比如我的samba访问地址为smb://222.222.222.200/www，想要挂载到/mnt/www下。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /mnt</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo mkidr www</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo mount t cifs //222.222.222.200/www /mnt/www -o username=pi@WORKGROUP,password=passwd,iocharset=utf8,rw,file_mode=0777,dir_mode=0777,uid=pi</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> /mnt/www</span></span></pre></td></tr><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> touch hello.world</span></span></pre></td></tr></table></figure></div></article></div></main><footer><div class="paginator"><a href="/Linux/note/" class="prev">上一篇</a><a href="/Linux/%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D/" class="next">下一篇</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'maohhgg';
var disqus_identifier = 'Linux/linux-mount-smaba/';
var disqus_title = 'Linux挂载smaba目录';
var disqus_url = 'http://maohhgg.github.io/Linux/linux-mount-smaba/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//maohhgg.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2019 <a href="http://maohhgg.github.io">maohhgg</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/maohhgg/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-110078780-1",'auto');ga('send','pageview');</script></body></html>